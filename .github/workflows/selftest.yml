name: self-test

on:
  schedule:
    # Dagelijks 18:00 NL-tijd â‰ˆ 16:00 UTC in de zomertijd
    # LET OP: GitHub gebruikt UTC; in de winter is NL-tijd UTC+1.
    - cron: "0 16 * * *"
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Health
        run: curl -sS "$API_URL/healthz"
        env:
          API_URL: ${{ secrets.LLM_STARTER_API_URL }}

      - name: Real self-test
        run: |
          curl -sS -X GET "$API_URL/self-test" \
            -H "X-API-Key: $API_ACCESS_KEY"
        env:
          API_URL: ${{ secrets.LLM_STARTER_API_URL }}
          API_ACCESS_KEY: ${{ secrets.API_ACCESS_KEY }}
